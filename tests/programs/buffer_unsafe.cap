package unsafe
module buffer_unsafe
use sys::root
use sys::console
use sys::mem

pub fn main(rc: RootCap) -> i32 {
  let c = rc.mint_console()
  let alloc = mem.alloc_default()
  match mem.buffer_new(alloc, 3) {
    Ok(b) => {
      let len = b.len()
      if (len == 3) {
        c.println("buffer ok")
      } else {
        c.println("buffer bad")
      }
      let slice = b.as_slice()
      let s_len = slice.len()
      if (s_len == 3) {
        c.println("slice ok")
      } else {
        c.println("slice bad")
      }
      mem.buffer_free(alloc, b)
      return 0
    }
    Err(e) => {
      c.println("buffer err")
      return 1
    }
  }
}

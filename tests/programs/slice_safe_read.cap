package safe
module slice_safe_read
use sys::system

pub fn main(rc: RootCap) -> i32 {
  let c = rc.mint_console()
  let alloc = rc.mint_alloc_default()
  let v = alloc.vec_u8_new()
  match (v.push('\x00')) {
    Ok(_) => { }
    Err(_) => { c.assert(false); alloc.vec_u8_free(v); return 1 }
  }
  let slice = v.as_slice()
  let b = slice.at(0)
  c.assert(b == '\x00')
  if (b == '\x00') {
    c.println("slice read ok")
  } else {
    c.println("slice read bad")
  }
  alloc.vec_u8_free(v)
  return 0
}

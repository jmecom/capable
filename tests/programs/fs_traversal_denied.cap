module fs_traversal_denied
use sys::system
use sys::fs
use sys::console

pub fn main(sys: RootCap) -> i32 {
  let c = sys.mint_console()
  let rfs = sys.mint_readfs("./config")

  match fs::read_to_string(rfs, "../secrets.txt") {
    Ok(s) => { console::println(c, "BUG: escaped"); return 2 }
    Err(e) => { console::println(c, "denied"); return 0 }
  }
}
